# 登录注册
## 方案
1. 登录注册的返回地址种类：
平台内发起的请求，地址是内部跳转地址或者app的地址
平台外发起的请求，是外部跳转地址
1. 授权和手机注册后，用户就注册成功了。

## 注册方式

* 同一个UnionID的是一个账号，需把**公众号和应用绑定到一个开放平台账号下**
  * [微信UnionID资料](https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1445241432)
  * 为了识别用户，每个用户针对每个公众号会产生一个安全的OpenID，如果需要在多公众号、移动应用之间做用户共通，则需前往微信开放平台，将这些公众号和应用绑定到一个开放平台账号下，绑定后，一个用户虽然对多个公众号和应用有多个不同的OpenID，但他对所有这些同一开放平台账号下的公众号和应用，只有一个UnionID
* 同一个账户必须绑定同一个用户的微信账号（app授权和开放平台授权，基于UnionID）

|方式        | 默认信息要求  |  说明 |
| --------   | -----  | ----  |
| 手机号注册    |   无 | |
| app授权(微信/QQ)    |   无 | |
| 微信开放平台授权(订阅号/服务号)    |   无 | |

## 流程
1. 用户未登录情况下点击了应用
1. 携带应用号跳转到登录页面
1. 登录，授权，注册。
1. 如需要完善信息则跳转到完善信息页面（携带应用号）。如无必须的用户信息，则自动pass完善信息页面。
1. 完善后跳转到应用页。地址流程如下：
获取跳转应用页地址(动态地址通过后端获取)。前端处理本地址(iframe):
```java
if (非平台方应用 && !外部跳转地址)
    加iframe
```
如是登录情况下，从第4步开始流程，开始前需提醒用户需补充的信息。

## 页面
登录注册页面：应用号，外部跳转地址(redirectUrl,外部发起的请求，无需页面头部和底部)，内部跳转地址(url)
完善信息页面：同上。根据信息需求提示用户输入，已有的信息的不必显示。

## 后端接口
授权注册，手机注册
完善信息
用户信息符合检查：登录状态除外

# 账号合并(方案废弃)
## 原则
1. 手机和社交账号都是账户的信息，每个账户的每种类型信息都只有一个。
1. 手机号只能绑定一个账户
1. 支持账户合并：设置里可以账号绑定（提示要合并信息）
1. 账号合并后，被合并账号的数据清空，包括账号密码，手机号等。
如账号A有手机号1，账号B有手机号2，B合并到A，则释放手机号2

## 方式

|方式        | 手机号  |  说明 |
| --------   | -----  | ----  |
| 手机号注册    |   有 | |
| app授权(微信/QQ)    |   无 | |
| 微信服务号授权    |   无 | |

## 废弃
* 原因：实名，合并数据风险很大
* 方案：注册时必须提供手机号，没有账号合并
