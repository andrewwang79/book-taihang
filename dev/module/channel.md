# 渠道对接

##概念
 第三方的网站需要调用我方的服务的过程，称为渠道对接。第三方称为渠道方。

##功能
1. 不同的渠道开通不同的服务
1. 特定服务下，不同的渠道有不同的设置。比如城市服务去掉2个
1. 关闭登录功能
1. 只能在服务范围内操作，不能后退到其他服务

##后台设计
1. 渠道表记录各个渠道；
1. 渠道服务表，控制渠道对应的服务

###表结构
渠道表  th_channel

|列名|字段|类型|NULL|说明|
|:--------:|:--------:|:--------:|:--------:|:--------:|
|编号|id|LONG|N||
|编码|code|VARCHAR(50)|N| |
|名称|name|VARCHAR(50)|N| |
|创建时间|createtime|DATE|N| |
|状态|status|INT|N| ||

渠道服务表  th_channel_serv

|列名|字段|类型|NULL|说明|
|:--------:|:--------:|:--------:|:--------:|:--------:|
|编号|id|LONG|N||
|渠道id|channelId|LONG|N| |
|服务|serv|VARCHAR(50)|N| |
|启用|enable|boolean|N| |
|模板|template|int|N| 1=完整版,2=精简版|
|配置|config|text|Y| json格式，动态设置服务内容。比如页面头部的颜色|



##前端设计
1. 关闭登录功能
2. 如果服务需要加头部，则加上渠道方头部
3. 根据渠道方提供后退地址回退。只能在服务范围内操作，不能后退到其他服务
4. 容器接入模式无需本参数，页面接入模式需要本参数值需url编码

# 附录  与渠道方对接文档
##说明
###文档目标
与渠道方定义一个数据交互接口规范，实现渠道方与智橙生活有效对接，加快业务处理流程。

##接入
###材料
我司提供：渠道号


####接入方式
H5页面：
1. 容器接入，容器有webview，不支持iframe
2. 页面直接接入，需要后退地址

###接口定义
####请求参数

service.html

|名称 |字段 |类型 |NULL |说明|
|:--------:|:--------:|:--------:|:--------:|:--------:|
|渠道号| c| String| N |
|服务 |serv| String |N |服务编码|
|后退地址 |back_url |String |N| 容器接入模式无需本参数，页面接入模式需要本参数值需url编码|
|经度 |lat| Number |Y |用户所在坐标的经度|
|纬度 |lng |Number| Y |用户所在坐标的纬度|
|显示方式 |display |string| Y |默认是竖屏。l=横屏，p=竖屏|
|终端类型 |terminal |string |Y |默认是手机。m=手机，p=平板|

####实例
http://site/service.html?c=xyz&serv=sqfw&lat=101.442342&lng=120.345354

##服务列表
|名称 |编码 |说明|
|:--------:|:--------:|:--------:|
|社区服务 |COMM_SERV ||
|城市服务 |CITY| |
|肉菜追溯码查询 |FOOD_QUERY ||
